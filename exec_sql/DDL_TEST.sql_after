CREATE TABLE PData2.T98_ACCT_KPI_DD (
      ACT_IDN_SKY CHAR(16) NOT NULL COMMENT '帐号',
      CRY_CDE CHAR(3) COMMENT '货币代码' ,
      DQT_LVL_CDE SMALLINT COMMENT '迟缴级别代码' ,
      ITL_BCH_IDN CHAR(20) COMMENT '机构编号',
      TOP_ITL_BCH_IDN CHAR(20) COMMENT '顶层账户所属机构编号' ,
      CSR_IDN_SKY CHAR(20) COMMENT '当事人编号',
      PDT_IDN_CDE CHAR(4) COMMENT '卡产品类型编号' ,
      ACT_TYP_IDN_CDE CHAR(4) COMMENT '帐户类型代码' ,
      ACT_CGY_CDE CHAR(1) COMMENT '帐户分类代码' ,
      LEF_ACT_FLAG CHAR(1) COMMENT '叶子协议标志' ,
      CRD_OPE_DTE DATE COMMENT '开卡日期' ,
      OPE_DTE DATE COMMENT '开户日期' ,
      ACT_FNS_STS_CDE CHAR(1) COMMENT '财务状态代码' ,
      STY_IDN_CDE CHAR(4) COMMENT '卡片类型代码' ,
      MAN_SPY_IND CHAR(1) COMMENT '主附卡标志' ,
      INI_CDT_LMT_CDE CHAR(1) COMMENT '初始信用限额分段代码' ,
      CC_NBR VARCHAR(25) COMMENT '营销活动编号（CC）',
      IN_NBR VARCHAR(25) COMMENT '进件编号（IN）',
      EX_NBR VARCHAR(25) COMMENT '外部销售代理（EX）',
      DS_NBR VARCHAR(25) COMMENT '直销团队编号（DS）',
      EXG_RTE DECIMAL(18,8) COMMENT '汇率' ,
      CDT_BAL DECIMAL(18,2) COMMENT '应收帐款' ,
      LIST_CDT_BAL DECIMAL(18,2) COMMENT '专向分期应收帐款' ,
      ACT_BAL DECIMAL(18,2) COMMENT '账户余额' ,
      ACCT_INT DECIMAL(18,2) COMMENT '应收利息' ,
      ACCT_FEE DECIMAL(18,2) COMMENT '应收费用' ,
      IST_OSG_AMT DECIMAL(18,2) COMMENT '未入帐分期付款' ,
      RSV_AMT DECIMAL(18,2) COMMENT '计提准备金余额' ,
      XJ_CDT_BAL DECIMAL(18,2) COMMENT '现金分期已入账' ,
      XJ_IST_OSG_AMT DECIMAL(18,2) COMMENT '现金分期未入账金额' ,
      INS2_IST_OSG_AMT_RMB DECIMAL(18,2) COMMENT '大额分期未入账金额' ,
      CSM_CNT INTEGER COMMENT '本月消费笔数' ,
      CSM_AMT_RMB DECIMAL(20,4) COMMENT '本月消费金额（折人民币）' ,
      CMN_CSM_CNT INTEGER COMMENT '普通消费笔数' ,
      CMN_CSM_AMT_RMB DECIMAL(18,2) COMMENT '普通消费金额' ,
      ILT_PLN_CNT INTEGER COMMENT '分期付款计划笔数' ,
      ILT_PLN_AMT_RMB DECIMAL(18,2) COMMENT '分期付款计划金额' ,
      ILT_PTG_CNT INTEGER COMMENT '分期付款入账笔数' ,
      ILT_PTG_AMT_RMB DECIMAL(18,2) COMMENT '分期付款入账金额' ,
      PYR_ILT_PTG_AMT_RMB DECIMAL(18,2) COMMENT '往年分期当月入账金额' ,
      CSH_WDL_CNT INTEGER COMMENT '本月取现笔数' ,
      CSH_WDL_AMT_RMB DECIMAL(20,4) COMMENT '本月取现金额（折人民币）' ,
      PYT_CNT INTEGER COMMENT '本月还款笔数',
      PYT_AMT_RMB DECIMAL(20,4) COMMENT '本月还款金额（折人民币）' ,
      CDT_BAL_RMB_ACCT DECIMAL(20,4) COMMENT '应收账款（会计日折人民币）' ,
      NON_ACR_INT_RMB_ACCT DECIMAL(20,4) COMMENT '非应计利息（会计日折人民币）' ,
      IST_OSG_AMT_RMB_ACCT DECIMAL(20,4) COMMENT '未入账分期付款（会计日折人民币）' ,
      OSD_CMN_CSM_CNT INTEGER COMMENT '跨境普通消费笔数',
      OSD_CMN_CSM_AMT DECIMAL(18,2) COMMENT '跨境普通消费金额' ,
      OSD_ILT_PLN_CNT INTEGER COMMENT '跨境外币分期笔数',
      OSD_ILT_PLN_AMT DECIMAL(18,2) COMMENT '跨境外币分期金额' ,
      OSD_CSH_WDL_CNT INTEGER COMMENT '跨境取现笔数',
      OSD_CSH_WDL_AMT DECIMAL(18,2) COMMENT '跨境取现金额' ,
      GA_ILT_PLN_CNT INTEGER COMMENT '港澳商户分期笔数',
      GA_ILT_PLN_AMT DECIMAL(18,2) COMMENT '港澳商户分期金额' ,
      TSF_ACT_FLAG CHAR(1) COMMENT '出让账户标志' ,
      DSF_ZFB_NUM DECIMAL(18,0) COMMENT '支付宝支付交易笔数',
      DSF_ZFB_RMB DECIMAL(24,2) COMMENT '支付宝支付交易金额' ,
      DSF_WEX_NUM DECIMAL(18,0) COMMENT '微信支付交易笔数',
      DSF_WEX_RMB DECIMAL(24,2) COMMENT '微信支付交易金额' ,
      DSF_WEP_NUM DECIMAL(18,0) COMMENT '唯品会支付交易笔数',
      DSF_WEP_RMB DECIMAL(24,2) COMMENT '唯品会支付交易金额' ,
      DSF_JND_NUM DECIMAL(18,0) COMMENT '京东支付交易笔数',
      DSF_JND_RMB DECIMAL(24,2) COMMENT '京东支付交易金额' ,
      DSF_MET_NUM DECIMAL(18,0) COMMENT '美团支付交易笔数',
      DSF_MET_RMB DECIMAL(24,2) COMMENT '美团支付交易金额' ,
      DSF_ALL_NUM DECIMAL(18,0) COMMENT '第三方支付交易笔数',
      DSF_ALL_RMB DECIMAL(24,2) COMMENT '第三方支付交易金额' ,
      CYC_LIMT_ACT_FLAG VARCHAR(2) COMMENT '循环信用账户标识' ,
      RVL_CRD_AMT DECIMAL(18,2) COMMENT '循环信用透支金额' )
 
PARTITIONED BY (STT_DTE DATE) 
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' 
STORED AS PARQUET TBLPROPERTIES("parquet.compress"="snappy");

CREATE TABLE PData2.T05_EVENT (
      EVT_IDN CHAR(30) NOT NULL COMMENT '事件编号',
      CNL_TYP_CDE CHAR(3) NOT NULL COMMENT '渠道类型代码' ,
      TXN_DTE DATE COMMENT '交易日期',
      TXN_TME TIME(0) COMMENT '交易时间',
      TXN_PFE_TXN_CDE CHAR(4) NOT NULL COMMENT '交易代码' ,
      PAN_TXT CHAR(28) NOT NULL COMMENT '卡号' ,
      ACT_IDN_SKY CHAR(16) NOT NULL COMMENT '帐号',
      BM_CRD_NBR CHAR(30) COMMENT '基准卡号',
      CLE_NBR SMALLINT NOT NULL COMMENT '周期编号' ,
      TXN_SMY_IDN_NBR SMALLINT NOT NULL COMMENT '交易流水号' ,
      DBT_CDT_CDE CHAR(4) COMMENT '借贷类型代码' ,
      OGL_TXN_CRY_CDE CHAR(3) NOT NULL COMMENT '交易币种代码' ,
      OGL_TXN_AMT DECIMAL(18,2) COMMENT '交易金额' ,
      RMB_TXN_AMT DECIMAL(18,2) COMMENT '交易金额（折人民币）' ,
      PTG_CRY_CDE CHAR(3) COMMENT '入帐币种代码' ,
      PTG_TXN_AMT DECIMAL(18,2) COMMENT '入帐金额' ,
      ICE_SLT_FEE DECIMAL(18,2) COMMENT '交换清算费收入' ,
      MCC_TXT CHAR(4) NOT NULL COMMENT 'MCC代码' ,
      MHT_NBR CHAR(18) COMMENT '商户号' ,
      TXN_SRC_CDE CHAR(4) NOT NULL COMMENT '事件来源类型代码' ,
      TXN_ON_SMT_IND CHAR(1) COMMENT '对帐单标志' ,
      TXN_STS_CDE CHAR(4) NOT NULL COMMENT '卡事件争议状态代码' ,
      PTG_ACT_IDN_SKY CHAR(16) COMMENT '入帐帐号',
      SLT_ACT_IDN_SKY CHAR(16) COMMENT '清算账号',
      ATO_NBR CHAR(6) COMMENT '授权号' ,
      PCS_CDE_NBR DECIMAL(18,2) COMMENT '处理码' ,
      PSV_DTA_CDE_TXT CHAR(12) COMMENT 'POS输入方式代码' ,
      CNL_IDN CHAR(25) NOT NULL COMMENT '渠道编号' ,
      TXN_DES_TXT CHAR(43) COMMENT '交易描述' ,
      EVT_TYP_CDE CHAR(1) NOT NULL COMMENT '事件类型代码' ,
      EVT_PLE_CDE CHAR(4) NOT NULL COMMENT '交易发生地点' ,
      IXS_RFE_NBR CHAR(16) COMMENT 'IXS参考号' ,
      MTH_SDL_ERR_IND CHAR(1) COMMENT '本代本交易渠道标识',
      MTXN_NOPW_FLAG CHAR(1) COMMENT '小额免密标识',
      VALUE_ADDED_TAX_AMT DECIMAL(18,2) COMMENT '手续费税',
      NOT_ACCU_POT_IND CHAR(1) COMMENT '不累计积分标识',
      UPD_DTE DATE COMMENT '更新日期' )
 
PARTITIONED BY (PTG_DTE DATE) 
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' 
STORED AS PARQUET TBLPROPERTIES("parquet.compress"="snappy");